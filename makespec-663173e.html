<!DOCTYPE html>
<html lang="de_DE:de:en_GB:en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Jakob Voß" />
  <meta name="date" content="2013-11-15" />
  <title>Creating specifications with makespec</title>
   <!--[if lt IE 9]>
    <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <style type="text/css">
  body { font-family: sans-serif; }
  a { text-decoration: none }
  a:hover { text-decoration: underline }
  h1 { font: 170% sans-serif }
  h1.title { font-size: 200%; font-weight: bold; }
  h2 { font: 140% sans-serif }
  h3 { font: 120% sans-serif }
  dt { font-weight: bold; }
  h1, h2, h3, h1 a, h2 a, h3 a { color: #005A9C; }
  table { border-collapse: collapse; }
  td { border: 1px solid #999; padding: 3px }
  dl p { margin-top: 0; }
  dt { margin-top: 0.8em; }
  dd { margin-left: 1.5em; }
  ol { margin-bottom: 1em; }
  table + p { margin-top: 1em; }
  </style>
</head>
<body>
<a href="https://github.com/jakobib/makespec/"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub"></a>
<header>
<h1 class="title">Creating specifications with makespec</h1>
<h3 class="author">Jakob Voß</h3>
<h4 class="date">2013-11-15 (version 0.38)</h4>
</header>

<h1>Table of Contents</h1>
<nav id="TOC">
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#usage"><span class="toc-section-number">2</span> Usage</a><ul>
<li><a href="#setup"><span class="toc-section-number">2.1</span> Setup</a></li>
<li><a href="#workflow"><span class="toc-section-number">2.2</span> Workflow</a></li>
<li><a href="#configuration"><span class="toc-section-number">2.3</span> Configuration</a><ul>
<li><a href="#basic-metadata"><span class="toc-section-number">2.3.1</span> Basic metadata</a></li>
<li><a href="#output-control"><span class="toc-section-number">2.3.2</span> Output control</a></li>
</ul></li>
<li><a href="#document-variables"><span class="toc-section-number">2.4</span> Document variables</a></li>
<li><a href="#template-variables"><span class="toc-section-number">2.5</span> Template variables</a></li>
<li><a href="#plugins"><span class="toc-section-number">2.6</span> Plugins</a><ul>
<li><a href="#include-plugin"><span class="toc-section-number">2.6.1</span> Include plugin</a></li>
</ul></li>
<li><a href="#requirements"><span class="toc-section-number">2.7</span> Requirements</a></li>
<li><a href="#versioning"><span class="toc-section-number">2.8</span> Versioning</a></li>
</ul></li>
<li><a href="#implementation"><span class="toc-section-number">3</span> Implementation</a><ul>
<li><a href="#how-documents-are-build"><span class="toc-section-number">3.1</span> How documents are build</a></li>
<li><a href="#how-schemas-are-build"><span class="toc-section-number">3.2</span> How schemas are build</a></li>
<li><a href="#interaction-with-github-or-another-git-remote"><span class="toc-section-number">3.3</span> Interaction with GitHub or another git remote</a></li>
</ul></li>
<li><a href="#examples"><span class="toc-section-number">4</span> Examples</a></li>
<li><a href="#extension"><span class="toc-section-number">5</span> Extension</a></li>
<li><a href="#revision-history"><span class="toc-section-number">6</span> Revision history</a></li>
</ul>
</nav>
<section class="level1" id="introduction">
<h1><a href="#introduction"><span class="header-section-number">1</span> Introduction</a></h1>
<p><strong>makespec</strong> simplifies creation and management of specifications and documentations. The program consists of a set of makefiles and templates to generate human-readable documents (HTML, PDF…) and formal schema files (OWL, Turtle, Relax-NG, BNF…) from a common source document written in <a href="http://johnmacfarlane.net/pandoc/demo/example9/pandocs-markdown.html">Pandoc Markdown</a>. Makespec also supports generating and updating <a href="http://pages.github.com/">GitHub pages</a> to publish the specification at GitHub. Feel free to reuse, <a href="https://github.com/jakobib/makespec/issues">comment</a>, fork, and modify makesec! The current version can be found at <a href="https://github.com/jakobib/makespec">https://github.com/jakobib/makespec</a>.</p>
</section>
<section class="level1" id="usage">
<h1><a href="#usage"><span class="header-section-number">2</span> Usage</a></h1>
<section class="level2" id="setup">
<a id="Setup"></a><h2><a href="#setup"><span class="header-section-number">2.1</span> Setup</a></h2>
<p>Best practice using makedoc is to host your specification in a git repository, optionally published at <a href="http://github.com/">GitHub</a>. Your repository should contain at least:</p>
<ul>
<li>The specification as Pandoc Markdown source file (e.g. <code>myspec.md</code>)</li>
<li><p>A <code>Makefile</code> with basic settings and <a href="#configuration">configuration</a>, such as:</p>
<pre><code>NAME=myspec
GITHUB=https://github.com/myaccount/myspec/

include makespec/Makefile</code></pre></li>
<li><p>A subdirectory <code>makespec</code> containing makespec. Best practice is inclusion as as git submodule. To do so in a new git repository:</p>
<pre><code>git submodule add https://github.com/jakobib/makespec.git</code></pre></li>
</ul>
<p>To clone an existing specification that uses makespace this way:</p>
<pre><code>git clone --recursive http://github.com/myaccount/myspec.git</code></pre>
<p>If you publish the specification as GitHub pages, you should not forget to also clone the <code>gh-pages</code> branch:</p>
<pre><code>git checkout -b gh-pages origin/gh-pages &amp;&amp; git checkout master</code></pre>
</section>
<section class="level2" id="workflow">
<a id="Workflow"></a><h2><a href="#workflow"><span class="header-section-number">2.2</span> Workflow</a></h2>
<p>Make sure you have the most recent version</p>
<pre><code>make pull</code></pre>
<p>Edit the specification source file in Markdown syntax, for instance with vim editor</p>
<pre><code>vim myspec.md</code></pre>
<p>Create a HTML version</p>
<pre><code>make html</code></pre>
<p>Commit to your repository</p>
<pre><code>git add Makefile myspec.md
git commit -m &quot;improved my fancy specification&quot;</code></pre>
<p>Create a <code>gh-pages</code> branch with the HTML version</p>
<pre><code>make website</code></pre>
<p>Publish</p>
<pre><code>make push</code></pre>
</section>
<section class="level2" id="configuration">
<a id="Configuration"></a><h2><a href="#configuration"><span class="header-section-number">2.3</span> Configuration</a></h2>
<section class="level3" id="basic-metadata">
<h3><a href="#basic-metadata"><span class="header-section-number">2.3.1</span> Basic metadata</a></h3>
<dl>
<dt>NAME</dt>
<dd><p>Required short name. Should not contain spaces and similar nasty characters.</p>
</dd>
<dt>SOURCE</dt>
<dd><p>Source file in Pandoc Markdown syntax, set to <code>$NAME.md</code> by default.</p>
</dd>
<dt>GITHUB</dt>
<dd><p>Github repository to link to in revision history.</p>
</dd>
<dt>TITLE</dt>
<dd><p>Title, unless already specified in the source file.</p>
</dd>
<dt>AUTHOR</dt>
<dd><p>List of authors, unless already specified in the source file.</p>
</dd>
<dt>DATE</dt>
<dd><p>Fixed date of publication. Set to a timestamp of the latest commit by default.</p>
</dd>
<dt>LANGUAGE</dt>
<dd><p>Document language code (passed to LaTeX or HTML).</p>
</dd>
<dt>ABSTRACT</dt>
<dd><p>A short abstract (in Markdown syntax) which is used as template variable ABSTRACT.</p>
</dd>
<dt>ABSTRACT_FROM</dt>
<dd><p>A file to read abstract from if no ABSTRACT was defined. Set to <code>abstract.md</code> by default.</p>
</dd>
</dl>
</section>
<section class="level3" id="output-control">
<h3><a href="#output-control"><span class="header-section-number">2.3.2</span> Output control</a></h3>
<dl>
<dt>REVISIONS</dt>
<dd><p>Number of revisions to show in the revision history (GIT_CHANGES).</p>
</dd>
<dt>FORMATS</dt>
<dd><p>If your specification contains a RDF ontology written in Turtle syntax, set <code>FORMATS=ttl owl</code>. More formats may be supported in the future. Format <code>html</code> is always enabled by default.</p>
</dd>
<dt>HTML_TEMPLATE</dt>
<dd><p>An optional Pandoc template for HTML output</p>
</dd>
<dt>HTML_TEMPLATE</dt>
<dd><p>An optional CSS file for HTML output</p>
</dd>
<dt>TEX_TEMPLATE</dt>
<dd><p>An optional Pandoc template for LaTeX and PDF output</p>
</dd>
</dl>
</section>
</section>
<section class="level2" id="document-variables">
<a id="Document variables"></a><h2><a href="#document-variables"><span class="header-section-number">2.4</span> Document variables</a></h2>
<p>The following variables, if enclosed in curly brackets (such as <code>{THIS_VARIABLE}</code>) are automatically replaced before conversion from Markdown syntax.</p>
<dl>
<dt>GIT_REVISION_DATE</dt>
<dd><p>timestamp of the latest commit.</p>
</dd>
<dt>GIT_REVISION_HASH</dt>
<dd><p>Short revision hash of the latest commit.</p>
</dd>
<dt>GIT_CHANGES</dt>
<dd><p>Revision history. Length can be set with configuration variable <code>REVISIONS</code>.</p>
</dd>
<dt>GIT_ATOM_FEED</dt>
<dd><p>URL of an Atom feed with revisions at GitHub.</p>
</dd>
<dt>ABSTRACT</dt>
<dd><p>Abstract, if defined with configuration variable <code>ABSTRACT</code> or <code>ABSTRACT_FROM</code>.</p>
</dd>
<dt>VERSION</dt>
<dd><p>The current version number (see <a href="#versioning">versioning</a>).</p>
</dd>
</dl>
</section>
<section class="level2" id="template-variables">
<a id="Template variables"></a><h2><a href="#template-variables"><span class="header-section-number">2.5</span> Template variables</a></h2>
<dl>
<dt>GITHUB</dt>
<dd><p>As defined in metadata variable GITHUB.</p>
</dd>
<dt>VERSION</dt>
<dd><p>The current version number (see <a href="#versioning">versioning</a>).</p>
</dd>
<dt>lang</dt>
<dd><p>As defined in metadata variable LANGUAGE.</p>
</dd>
</dl>
</section>
<section class="level2" id="plugins">
<a id="Plugins"></a><h2><a href="#plugins"><span class="header-section-number">2.6</span> Plugins</a></h2>
<p>Makespec makes use of several plugins of Pandoc Markdown syntax.</p>
<section class="level3" id="include-plugin">
<h3><a href="#include-plugin"><span class="header-section-number">2.6.1</span> Include plugin</a></h3>
<p>One can include markdown files with the following syntax:</p>
<pre><code>`filename.md`{.include}</code></pre>
<p>The inclusion statement should be placed on the begin of a single line. By now, inclusion is implemented on syntax level. A later version of this plugin will act on the abstract syntax tree.</p>
</section>
</section>
<section class="level2" id="requirements">
<a id="Requirements"></a><h2><a href="#requirements"><span class="header-section-number">2.7</span> Requirements</a></h2>
<ul>
<li>GNU Make</li>
<li>Perl &gt;= 5.14.1</li>
<li><a href="http://johnmacfarlane.net/pandoc/">Pandoc</a> version &gt;= 1.9</li>
<li><a href="http://librdf.org/raptor/rapper.html">Rapper</a> from Raptor RDF library (only if writing an RDF ontology)</li>
</ul>
</section>
<section class="level2" id="versioning">
<a id="Versioning"></a><h2><a href="#versioning"><span class="header-section-number">2.8</span> Versioning</a></h2>
<p>Document versioning is based on git commits and tags. The <strong><code>VERSION</code></strong> variable is set to the latest git tag, optionally appended by a revision counter and the suffix ‘<code>-dirty</code>’ for uncommitted changes. Version tags must start with the small letter ‘<code>v</code>’ followed by a digit. For instance if the latest commit was tagged as ‘<code>v1.3</code>’ then the version will be ‘<code>1.3</code>’. If two commits have been made since this tag, the version will be ‘<code>1.3rev2</code>’. If the git working copy further contains uncommitted changes, the version will be ‘<code>1.3rev2-dirty</code>’. Without tags, version number are just based on the number of commits, starting with ‘<code>rev0</code>’ (no commit).</p>
<p>The version number can be used both as <a href="#document-variables">document variable</a> (<code>{‍VERSION}</code>) and as <a href="#template-variables">template variable</a> (<code>$VERSION$</code>). The default templates show version numbers in parentheses, append to the date.</p>
</section>
</section>
<section class="level1" id="implementation">
<h1><a href="#implementation"><span class="header-section-number">3</span> Implementation</a></h1>
<p>Makespec consists of a set of makefiles and Pandoc templates.</p>
<section class="level2" id="how-documents-are-build">
<a id="How documents are build"></a><h2><a href="#how-documents-are-build"><span class="header-section-number">3.1</span> How documents are build</a></h2>
<pre><code>$SOURCE --&gt; $NAME.tmp.md --&gt; $NAME.(html|tex|pdf|odt...)</code></pre>
</section>
<section class="level2" id="how-schemas-are-build">
<a id="How schemas are build"></a><h2><a href="#how-schemas-are-build"><span class="header-section-number">3.2</span> How schemas are build</a></h2>
<p>Schema output files are extracted from code sections of the source file. All schemas are checked for syntax errors.</p>
<pre><code>$SOURCE --&gt; $(NAME).tmp.ttl --&gt; $(NAME).(tmp|owl)</code></pre>
</section>
<section class="level2" id="interaction-with-github-or-another-git-remote">
<a id="Interaction with GitHub or another git remote"></a><h2><a href="#interaction-with-github-or-another-git-remote"><span class="header-section-number">3.3</span> Interaction with GitHub or another git remote</a></h2>
<p><code>make pull</code>: git pull origin master gh-pages –tags</p>
<p><code>make push</code>: git push origin master gh-pages –tags</p>
</section>
</section>
<section class="level1" id="examples">
<h1><a href="#examples"><span class="header-section-number">4</span> Examples</a></h1>
<p>The following specifications make use of makespec:</p>
<ul>
<li><a href="https://github.com/gbv/ssso">Simple Service Status Ontology (SSSO)</a></li>
<li><a href="https://github.com/gbv/dso">Document Service Ontology (DSO)</a></li>
<li><a href="https://github.com/gbv/daiaspec">Document Availability Information API (DAIA)</a></li>
<li><a href="https://github.com/gbv/paia">Patrons Account Information API (PAIA)</a></li>
<li>…</li>
</ul>
<p>Last but not least, the documentation of makespec is also created with makespec.</p>
</section>
<section class="level1" id="extension">
<h1><a href="#extension"><span class="header-section-number">5</span> Extension</a></h1>
<p>The makefile <code>local.make</code> can be used for custom settings and extensions in forks of makespec. Please don’t commit this files together with changes to makespec core files to facilitate merging back changes of your fork into makespec.</p>
</section>
<section class="level1" id="revision-history">
<h1><a href="#revision-history"><span class="header-section-number">6</span> Revision history</a></h1>
<p><a href="https://github.com/jakobib/makespec/blob/master/README.md">This document</a> with version <em>0.38</em> was last modified at <em>2013-11-15</em> with hash <em><a href="https://github.com/jakobib/makespec/commit/663173eb01cea7ef7023416a6e89f9cf652bd09f">663173e</a></em>.</p>
<p>Also available as <a href="https://github.com/jakobib/makespec/commits/master.atom">Atom feed</a>.</p>
<ul>
<li><a href="makespec-419bf30.html"><code>2013-11-14 10:02:44 +0100</code></a>: <a href="https://github.com/jakobib/makespec/commit/419bf307f27e26fb40aa819bff78ffba87e9e3a8">better support variable GITHUB</a></li>
<li><a href="makespec-6287c9d.html"><code>2013-09-20 08:37:24 +0200</code></a>: <a href="https://github.com/jakobib/makespec/commit/6287c9d4328c64038f58b5d7944e6c1f8aa4fac2">added local extension hook</a></li>
<li><a href="makespec-888efd7.html"><code>2013-09-02 10:02:09 +0200</code></a>: <a href="https://github.com/jakobib/makespec/commit/888efd71468b667d12ee8617dd7ad5d435d005a9">document versioning</a></li>
<li><a href="makespec-4178554.html"><code>2013-08-30 09:51:22 +0200</code></a>: <a href="https://github.com/jakobib/makespec/commit/4178554a053c2281359cf7cde93f97d097027e80">support document language</a></li>
<li><a href="makespec-7b37b27.html"><code>2013-08-08 11:57:55 +0200</code></a>: <a href="https://github.com/jakobib/makespec/commit/7b37b277092dde4eb65ec89e02fdf1ec59d093b4">show and document VERSION</a></li>
</ul>
</section>
</body>
</html>
